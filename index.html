<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="format-detection" content="telephone=no">
    <meta name="msapplication-tap-highlight" content="no">
    
    <meta name="theme-color" content="#8B4513">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Panadería">
    <link rel="apple-touch-icon" href="icon-192.jpg">

    <title>Panadería</title>

    <link rel="manifest" href="manifest.json">
    
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        * {
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        input, textarea, select {
            -webkit-user-select: text;
            -moz-user-select: text;
            -ms-user-select: text;
            user-select: text;
        }
    </style>
</head>
<body>
    <div id="loading-indicator" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #f8f9fa; display: flex; align-items: center; justify-content: center; z-index: 9999;">
        <div style="text-align: center;">
            <div style="width: 40px; height: 40px; border: 4px solid #e3e3e3; border-top: 4px solid #8B4513; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 10px;"></div>
            <p>Cargando Panadería...</p>
        </div>
    </div>
    
    <div class="app-container" style="display: none;">
        <header class="header">
            <div class="header-content">
                <div class="logo">
                    <h1>Panadería</h1>
                    <span class="subtitle">----</span>
                </div>
                <nav class="nav-tabs">
                    <button class="nav-tab active" data-tab="productos">Productos</button>
                    <button class="nav-tab" data-tab="ventas">Punto de Venta</button>
                    <button class="nav-tab" data-tab="reportes">Reportes</button>
                </nav>
            </div>
        </header>

        <main class="main-content">
            <section id="productos" class="tab-content active">
                <div class="section-header">
                    <h2>Gestión de Productos</h2>
                    <button class="btn-primary" id="btn-nuevo-producto">+ Nuevo Producto</button>
                </div>
                
                <div class="products-grid" id="products-grid">
                </div>

                <div id="modal-producto" class="modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3 id="modal-title">Nuevo Producto</h3>
                            <button class="modal-close">&times;</button>
                        </div>
                        <form id="form-producto">
                            <div class="form-group">
                                <label for="nombre-producto">Nombre del Producto</label>
                                <input type="text" id="nombre-producto" required>
                            </div>
                            <div class="form-group">
                                <label for="precio-producto">Precio ($)</label>
                                <input type="number" id="precio-producto" step="0.01" required>
                            </div>
                            <div class="form-group">
                                <label for="categoria-producto">Categoría</label>
                                <select id="categoria-producto" required>
                                    <option value="">Seleccionar categoría</option>
                                    <option value="Panes">Panes</option>
                                    <option value="Pasteles">Pasteles</option>
                                    <option value="Lácteos">Lácteos</option>
                                    <option value="Otros">Otros</option>
                                </select>
                            </div>
                            <div class="form-actions">
                                <button type="button" class="btn-secondary" id="btn-cancelar">Cancelar</button>
                                <button type="submit" class="btn-primary">Guardar</button>
                            </div>
                        </form>
                    </div>
                </div>
            </section>

            <section id="ventas" class="tab-content">
                <div class="section-header">
                    <h2>Punto de Venta</h2>
                    <div class="total-display">
                        <span class="total-label">Total:</span>
                        <span class="total-amount" id="total-venta">$0.00</span>
                    </div>
                </div>

                <div class="sales-container">
                    <div class="products-selector">
                        <h3>Productos Disponibles</h3>
                        <div class="products-list" id="products-sale-list">
                        </div>
                    </div>

                    <div class="cart-container">
                        <h3>Carrito de Compra</h3>
                        <div class="cart-items" id="cart-items">
                        </div>
                        <div class="cart-actions">
                            <button class="btn-secondary" id="btn-limpiar-carrito">Limpiar</button>
                            <button class="btn-primary" id="btn-procesar-venta">Procesar Venta</button>
                        </div>
                    </div>
                </div>

                 Modal de pago con billetes mexicanos 
                <div id="modal-pago" class="modal">
                    <div class="modal-content modal-pago-content">
                        <div class="modal-header">
                            <h3>Procesar Pago</h3>
                            <button class="modal-close" id="modal-pago-close">&times;</button>
                        </div>
                        <div style="padding: var(--spacing-lg);">
                            <div class="payment-summary">
                                <div class="payment-row">
                                    <span class="payment-label">Total a Pagar:</span>
                                    <span class="payment-value total-pagar" id="pago-total">$0.00</span>
                                </div>
                            </div>
                            
                            <div class="payment-method-section">
                                <h4 style="margin-bottom: var(--spacing-sm); color: var(--color-text);">Método de Pago</h4>
                                <div class="payment-method-buttons">
                                    <button type="button" class="btn-payment-method active" data-method="billete">
                                        Con Billete
                                    </button>
                                    <button type="button" class="btn-payment-method" data-method="exacto">
                                        Pago Exacto
                                    </button>
                                </div>
                            </div>

                            <div id="billetes-section">
                                <h4 style="margin-bottom: var(--spacing-sm); color: var(--color-text);">Billetes Mexicanos</h4>
                                <div class="billetes-grid">
                                    <button type="button" class="btn-billete" data-amount="20">$20</button>
                                    <button type="button" class="btn-billete" data-amount="50">$50</button>
                                    <button type="button" class="btn-billete" data-amount="100">$100</button>
                                    <button type="button" class="btn-billete" data-amount="200">$200</button>
                                    <button type="button" class="btn-billete" data-amount="500">$500</button>
                                    <button type="button" class="btn-billete" data-amount="1000">$1000</button>
                                </div>
                                
                                <div class="form-group" style="margin-top: var(--spacing-md);">
                                    <label for="monto-recibido">Monto Recibido ($)</label>
                                    <input type="number" id="monto-recibido" step="0.01" min="0" placeholder="0.00">
                                </div>
                            </div>

                            <div class="payment-summary" id="cambio-section" style="display: none;">
                                <div class="payment-row cambio-row">
                                    <span class="payment-label">Cambio a Devolver:</span>
                                    <span class="payment-value cambio-value" id="cambio-devolver">$0.00</span>
                                </div>
                            </div>

                            <div class="form-actions">
                                <button type="button" class="btn-secondary" id="btn-cancelar-pago">Cancelar</button>
                                <button type="button" class="btn-primary" id="btn-confirmar-pago" disabled>Confirmar Venta</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="reportes" class="tab-content">
                 Añadir sección de cambio inicial del día 
                <div class="cambio-inicial-section">
                    <div class="cambio-inicial-card">
                        <h3>Cambio Inicial del Día</h3>
                        <div class="cambio-inicial-content">
                            <div class="cambio-inicial-display">
                                <span class="cambio-inicial-label">Cambio Inicial:</span>
                                <span class="cambio-inicial-value" id="cambio-inicial-display">$100.00</span>
                            </div>
                            <button class="btn-secondary btn-small" id="btn-editar-cambio-inicial">Editar</button>
                        </div>
                        <div class="cambio-inicial-form" id="cambio-inicial-form" style="display: none;">
                            <input type="number" id="input-cambio-inicial" step="0.01" min="0" value="100" placeholder="100.00">
                            <div style="display: flex; gap: var(--spacing-xs); margin-top: var(--spacing-xs);">
                                <button class="btn-primary btn-small" id="btn-guardar-cambio-inicial">Guardar</button>
                                <button class="btn-secondary btn-small" id="btn-cancelar-cambio-inicial">Cancelar</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="section-header">
                    <h2>Reportes de Ventas</h2>
                    <div class="report-filters">
                        <button class="btn-filter active" data-period="dia">Hoy</button>
                        <button class="btn-filter" data-period="semana">Esta Semana</button>
                        <button class="btn-filter" data-period="mes">Este Mes</button>
                    </div>
                </div>

                <div class="reports-container">
                    <div class="stats-cards">
                        <div class="stat-card">
                            <h4>Ventas del Día</h4>
                            <div class="stat-value" id="ventas-dia">$0.00</div>
                        </div>
                        <div class="stat-card">
                            <h4>Productos Vendidos</h4>
                            <div class="stat-value" id="productos-vendidos">0</div>
                        </div>
                        <div class="stat-card">
                            <h4>Promedio por Venta</h4>
                            <div class="stat-value" id="promedio-venta">$0.00</div>
                        </div>
                         Tarjeta de cambio del día 
                        <div class="stat-card">
                            <h4>Cambio Dejado Hoy</h4>
                            <div class="stat-value" id="cambio-dia">$0.00</div>
                        </div>
                    </div>

                     Sección de turnos 
                    <div class="turnos-section">
                        <h3>Ventas por Turno</h3>
                        <div class="turnos-cards">
                            <div class="turno-card">
                                <h4>Turno Mañana (7:30 - 11:30)</h4>
                                <div class="turno-stats">
                                    <div class="turno-stat">
                                        <span class="turno-label">Ventas:</span>
                                        <span class="turno-value" id="ventas-manana">$0.00</span>
                                    </div>
                                    <div class="turno-stat">
                                        <span class="turno-label">Productos:</span>
                                        <span class="turno-value" id="productos-manana">0</span>
                                    </div>
                                </div>
                            </div>
                            <div class="turno-card">
                                <h4>Turno Tarde (4:30 - 10:00)</h4>
                                <div class="turno-stats">
                                    <div class="turno-stat">
                                        <span class="turno-label">Ventas:</span>
                                        <span class="turno-value" id="ventas-tarde">$0.00</span>
                                    </div>
                                    <div class="turno-stat">
                                        <span class="turno-label">Productos:</span>
                                        <span class="turno-value" id="productos-tarde">0</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                     Desglose por categoría 
                    <div class="category-breakdown">
                        <h3>Desglose por Categoría (Hoy)</h3>
                        <div class="category-cards" id="category-cards">
                        </div>
                    </div>

                    <div class="sales-history">
                        <h3>Historial de Ventas</h3>
                        <div class="sales-table" id="sales-table">
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script src="script.js"></script>
    <script>
        console.log('[v0] Aplicación de panadería optimizada para APK');

        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('sw.js')
                    .then(function(registration) {
                        console.log('[v0] Service Worker registrado correctamente:', registration.scope);
                    })
                    .catch(function(error) {
                        console.log('[v0] Error registrando Service Worker:', error);
                    });
            });
        }

        function initializeApp() {
            try {
                const loading = document.getElementById('loading-indicator');
                const app = document.querySelector('.app-container');
                
                if (loading) loading.style.display = 'none';
                if (app) app.style.display = 'block';
                
                console.log('[v0] Interfaz cargada correctamente');
            } catch (error) {
                console.log('[v0] Error cargando interfaz:', error);
            }
        }

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeApp);
        } else {
            initializeApp();
        }

        window.addEventListener('load', function() {
            setTimeout(initializeApp, 300);
        });

        setTimeout(initializeApp, 1000);
    </script>
</body>
</html>
